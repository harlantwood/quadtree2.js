var Quadtree2   = require('../src/quadtree2'),
    Vec2        = require('vec2'),
    assert      = require('assert'),
    should      = require('should');

describe('Quadtree2', function(){
  context('with object in the middle', function() {
    it('should not return all other objects as possible colliding', function() {
      var qt = new Quadtree2(new Vec2(500, 500), 4);
      var o1 = { pos_ : new Vec2(472, 276), rad_ : 8 };
      qt.addObject(o1);
      var o2 = { pos_ : new Vec2(142, 407), rad_ : 20 };
      qt.addObject(o2);
      var o3 = { pos_ : new Vec2(44, 43), rad_ : 8 };
      qt.addObject(o3);
      var o4 = { pos_ : new Vec2(437, 46), rad_ : 12 };
      qt.addObject(o4);
      var o5 = { pos_ : new Vec2(457, 462), rad_ : 14 };
      qt.addObject(o5);
      var o6 = { pos_ : new Vec2(406, 464), rad_ : 13 };
      qt.addObject(o6);
      var o7 = { pos_ : new Vec2(409, 414), rad_ : 20 };
      qt.addObject(o7);
      var o8 = { pos_ : new Vec2(459, 410), rad_ : 18 };
      qt.addObject(o8);
      var o9 = { pos_ : new Vec2(325, 329), rad_ : 19 };
      qt.addObject(o9);
      var o10 = { pos_ : new Vec2(250, 251), rad_ : 11 };
      qt.addObject(o10);

      qt.debug(true);

      var quadrantIds = Object.keys(qt.data_.quadrants_[o10.id_]);
      quadrantIds.should.not.containEql('1');
      qt.getPossibleCollisionsForObject(o10).should.eql({ 3 : o3, 4 : o4, 2 : o2, 9 : o9 });
    });
  });

  context('with object in the middle', function() {
    it('should return correct possible colliding objects', function() {
      var qt = new Quadtree2(new Vec2(500, 500), 4);
      var o1 = { pos_ : new Vec2(119, 393.5), rad_ : 10 };
      qt.addObject(o1);
      var o2 = { pos_ : new Vec2(333, 429.5), rad_ : 11 };
      qt.addObject(o2);
      var o3 = { pos_ : new Vec2(390, 428.5), rad_ : 13 };
      qt.addObject(o3);
      var o4 = { pos_ : new Vec2(397, 95.5), rad_ : 14 };
      qt.addObject(o4);
      var o5 = { pos_ : new Vec2(373, 71.5), rad_ : 7 };
      qt.addObject(o5);
      var o6 = { pos_ : new Vec2(28, 64.5), rad_ : 2 };
      qt.addObject(o6);
      var o7 = { pos_ : new Vec2(251, 251.5), rad_ : 20 };
      qt.addObject(o7);

      qt.getPossibleCollisionsForObject(o7).should.eql({ 1 : o1, 2 : o2, 3 : o3, 4 : o4, 5 : o5, 6 : o6 });
    });
  });

  context('with object in the middle', function() {
    it('should return all the possible colliding objects', function() {
      var qt = new Quadtree2(new Vec2(500, 500), 4);
      var o1 = { pos_ : new Vec2(99, 75.5), rad_ : 20 };
      qt.addObject(o1);
      var o2 = { pos_ : new Vec2(397, 76.5), rad_ : 19 };
      qt.addObject(o2);
      var o3 = { pos_ : new Vec2(139, 372.5), rad_ : 15 };
      qt.addObject(o3);
      var o4 = { pos_ : new Vec2(425, 427.5), rad_ : 11 };
      qt.addObject(o4);
      var o5 = { pos_ : new Vec2(439, 339.5), rad_ : 7 };
      qt.addObject(o5);
      var o6 = { pos_ : new Vec2(251, 251.5), rad_ : 9 };
      qt.addObject(o6);
      var o7 = { pos_ : new Vec2(287, 337.5), rad_ : 20 };
      qt.addObject(o7);
      var o8 = { pos_ : new Vec2(335, 294.5), rad_ : 17 };
      qt.addObject(o8);

      qt.debug(true);

      qt.getPossibleCollisionsForObject(o6).should.eql({ 1 : o1, 2 : o2, 3 : o3, 4 : o4, 5 : o5, 7 : o7, 8 : o8 });
    });
  });

  context('with object in the middle', function() {
    it('should refactor itself', function() {
      var qt = new Quadtree2(new Vec2(500, 500), 4);
      var o1 = { pos_ : new Vec2(106, 80.5), rad_ : 7 };
      qt.addObject(o1);
      var o2 = { pos_ : new Vec2(345, 86.5), rad_ : 6 };
      qt.addObject(o2);
      var o3 = { pos_ : new Vec2(102, 473.5), rad_ : 2 };
      qt.addObject(o3);
      var o4 = { pos_ : new Vec2(397, 473.5), rad_ : 11 };
      qt.addObject(o4);
      var o5 = { pos_ : new Vec2(425, 441.5), rad_ : 15 };
      qt.addObject(o5);
      var o6 = { pos_ : new Vec2(250, 251.5), rad_ : 20 };
      qt.addObject(o6);
      qt.debug(true);
      var o7 = { pos_ : new Vec2(274, 343.5), rad_ : 6 };
      qt.addObject(o7);
      var o8 = { pos_ : new Vec2(326, 340.5), rad_ : 17 };
      qt.addObject(o8);
      var o9 = { pos_ : new Vec2(338, 301.5), rad_ : 20 };
      qt.addObject(o9);

      qt.getPossibleCollisionsForObject(o6).should.eql({ 1 : o1, 2 : o2, 3 : o3, 7 : o7, 8 : o8, 9 : o9 });
    });
  });

  context('with moving objects', function() {
    it('should refactor itself', function() {
      var qt = new Quadtree2(new Vec2(500, 500), 4);
      var o1 = { pos_ : new Vec2(37, 413.5), rad_ : 4 };
      qt.addObject(o1);
      var o2 = { pos_ : new Vec2(27, 302.5), rad_ : 12 };
      qt.addObject(o2);
      var o3 = { pos_ : new Vec2(185, 320.5), rad_ : 10 };
      qt.addObject(o3);
      var o4 = { pos_ : new Vec2(118, 464.5), rad_ : 12 };
      qt.addObject(o4);
      var o5 = { pos_ : new Vec2(277, 441.5), rad_ : 2 };
      qt.addObject(o5);
      var o6 = { pos_ : new Vec2(364, 191.5), rad_ : 19 };
      qt.addObject(o6);
      var o7 = { pos_ : new Vec2(285, 58.5), rad_ : 14 };
      qt.addObject(o7);
      var o8 = { pos_ : new Vec2(143, 58.5), rad_ : 5 };
      qt.addObject(o8);
      var o9 = { pos_ : new Vec2(51, 101.5), rad_ : 18 };
      qt.addObject(o9);
      var o10 = { pos_ : new Vec2(104, 204.5), rad_ : 9 };
      qt.addObject(o10);
      var o11 = { pos_ : new Vec2(186, 194.5), rad_ : 18 };
      qt.addObject(o11);
      var o12 = { pos_ : new Vec2(386, 316.5), rad_ : 18 };
      qt.addObject(o12);
      var o13 = { pos_ : new Vec2(488, 418.5), rad_ : 20 };
      qt.addObject(o13);
      var o14 = { pos_ : new Vec2(370, 455.5), rad_ : 3 };
      qt.addObject(o14);
      o12.pos_ = new Vec2(394, 333.5);
      o12.pos_ = new Vec2(394, 333.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(394, 334.5);
      o12.pos_ = new Vec2(393, 335.5);
      o12.pos_ = new Vec2(392, 337.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(391, 338.5);
      o12.pos_ = new Vec2(390, 339.5);
      o12.pos_ = new Vec2(388, 341.5);
      o12.pos_ = new Vec2(386, 343.5);
      o12.pos_ = new Vec2(384, 343.5);
      o12.pos_ = new Vec2(379, 347.5);
      o12.pos_ = new Vec2(372, 348.5);
      o12.pos_ = new Vec2(368, 350.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(364, 352.5);
      o12.pos_ = new Vec2(362, 352.5);
      o12.pos_ = new Vec2(362, 353.5);
      o12.pos_ = new Vec2(360, 353.5);
      o12.pos_ = new Vec2(358, 355.5);
      o12.pos_ = new Vec2(354, 358.5);
      o12.pos_ = new Vec2(350, 361.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(343, 364.5);
      o12.pos_ = new Vec2(331, 368.5);
      o12.pos_ = new Vec2(319, 372.5);
      o12.pos_ = new Vec2(307, 376.5);
      o12.pos_ = new Vec2(295, 379.5);
      o12.pos_ = new Vec2(284, 383.5);
      o12.pos_ = new Vec2(275, 387.5);
      o12.pos_ = new Vec2(271, 387.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(267, 387.5);
      o12.pos_ = new Vec2(263, 388.5);
      o12.pos_ = new Vec2(261, 388.5);
      o12.pos_ = new Vec2(256, 388.5);
      o12.pos_ = new Vec2(251, 388.5);
      o12.pos_ = new Vec2(244, 388.5);
      o12.pos_ = new Vec2(238, 388.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(232, 388.5);
      o12.pos_ = new Vec2(225, 388.5);
      o12.pos_ = new Vec2(217, 388.5);
      o12.pos_ = new Vec2(210, 390.5);
      o12.pos_ = new Vec2(205, 390.5);
      o12.pos_ = new Vec2(204, 390.5);
      o12.pos_ = new Vec2(203, 390.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(202, 390.5);
      o12.pos_ = new Vec2(201, 390.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(200, 390.5);
      o12.pos_ = new Vec2(199, 390.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(201, 390.5);
      o12.pos_ = new Vec2(202, 390.5);
      o12.pos_ = new Vec2(203, 390.5);
      o12.pos_ = new Vec2(206, 389.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(209, 388.5);
      o12.pos_ = new Vec2(216, 386.5);
      o12.pos_ = new Vec2(229, 383.5);
      o12.pos_ = new Vec2(244, 380.5);
      o12.pos_ = new Vec2(259, 373.5);
      o12.pos_ = new Vec2(276, 368.5);
      o12.pos_ = new Vec2(293, 362.5);
      o12.pos_ = new Vec2(312, 355.5);
      qt.updateObject(o12);
      o12.pos_ = new Vec2(329, 348.5);
      o12.pos_ = new Vec2(340, 346.5);
      o12.pos_ = new Vec2(351, 343.5);
      o12.pos_ = new Vec2(358, 340.5);
      o12.pos_ = new Vec2(359, 340.5);
      qt.updateObject(o12);

      qt.getPossibleCollisionsForObject(o3).should.eql({ 1 : o1, 2 : o2, 4 : o4 });
    });
  });

  context('with moving objects on quadrant corners', function() {
    it('should not remove necessary quadrant', function() {
      var qt = new Quadtree2(new Vec2(500, 500), 4);
      var o1 = { pos_ : new Vec2(122, 119.5), rad_ : 7 };
      qt.addObject(o1);
      var o2 = { pos_ : new Vec2(296, 80.5), rad_ : 8 };
      qt.addObject(o2);
      var o3 = { pos_ : new Vec2(99, 267.5), rad_ : 1 };
      qt.addObject(o3);
      var o4 = { pos_ : new Vec2(373, 414.5), rad_ : 6 };
      qt.addObject(o4);
      var o5 = { pos_ : new Vec2(132, 446.5), rad_ : 13 };
      qt.addObject(o5);
      var o6 = { pos_ : new Vec2(391, 297.5), rad_ : 13 };
      qt.addObject(o6);
      var o7 = { pos_ : new Vec2(252, 202.5), rad_ : 3 };
      qt.addObject(o7);
      var o8 = { pos_ : new Vec2(361, 111.5), rad_ : 18 };
      qt.addObject(o8);
      var o9 = { pos_ : new Vec2(294, 311.5), rad_ : 7 };
      qt.addObject(o9);
      var o10 = { pos_ : new Vec2(173, 310.5), rad_ : 18 };
      qt.addObject(o10);
      var o11 = { pos_ : new Vec2(194, 85.5), rad_ : 16 };
      qt.addObject(o11);
      var o12 = { pos_ : new Vec2(252, 63.5), rad_ : 8 };
      qt.addObject(o12);
      var o13 = { pos_ : new Vec2(394, 53.5), rad_ : 18 };
      qt.addObject(o13);
      var o14 = { pos_ : new Vec2(473, 207.5), rad_ : 11 };
      qt.addObject(o14);
      var o15 = { pos_ : new Vec2(297, 190.5), rad_ : 20 };
      qt.addObject(o15);
      var o16 = { pos_ : new Vec2(151, 216.5), rad_ : 5 };
      qt.addObject(o16);
      var o17 = { pos_ : new Vec2(361, 366.5), rad_ : 20 };
      qt.addObject(o17);
      var o18 = { pos_ : new Vec2(92, 363.5), rad_ : 20 };
      qt.addObject(o18);
      o15.pos_ = new Vec2(288, 191.5);
      o15.pos_ = new Vec2(288, 191.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(288, 192.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(287, 193.5);
      o15.pos_ = new Vec2(286, 194.5);
      o15.pos_ = new Vec2(286, 195.5);
      o15.pos_ = new Vec2(284, 195.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(284, 196.5);
      o15.pos_ = new Vec2(284, 198.5);
      o15.pos_ = new Vec2(282, 198.5);
      o15.pos_ = new Vec2(280, 200.5);
      o15.pos_ = new Vec2(280, 201.5);
      o15.pos_ = new Vec2(280, 202.5);
      o15.pos_ = new Vec2(278, 205.5);
      o15.pos_ = new Vec2(276, 207.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(276, 208.5);
      o15.pos_ = new Vec2(275, 210.5);
      o15.pos_ = new Vec2(275, 213.5);
      o15.pos_ = new Vec2(274, 215.5);
      o15.pos_ = new Vec2(273, 216.5);
      o15.pos_ = new Vec2(273, 217.5);
      o15.pos_ = new Vec2(272, 219.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(272, 220.5);
      o15.pos_ = new Vec2(271, 221.5);
      o15.pos_ = new Vec2(270, 223.5);
      o15.pos_ = new Vec2(269, 224.5);
      o15.pos_ = new Vec2(268, 225.5);
      o15.pos_ = new Vec2(268, 226.5);
      o15.pos_ = new Vec2(267, 228.5);
      o15.pos_ = new Vec2(266, 230.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(265, 230.5);
      o15.pos_ = new Vec2(264, 232.5);
      o15.pos_ = new Vec2(263, 234.5);
      o15.pos_ = new Vec2(262, 235.5);
      o15.pos_ = new Vec2(261, 235.5);
      o15.pos_ = new Vec2(261, 236.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(260, 237.5);
      o15.pos_ = new Vec2(259, 238.5);
      o15.pos_ = new Vec2(258, 239.5);
      o15.pos_ = new Vec2(257, 240.5);
      o15.pos_ = new Vec2(257, 241.5);
      o15.pos_ = new Vec2(257, 242.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(257, 243.5);
      o15.pos_ = new Vec2(257, 244.5);
      o15.pos_ = new Vec2(256, 245.5);
      o15.pos_ = new Vec2(256, 247.5);
      o15.pos_ = new Vec2(255, 247.5);
      o15.pos_ = new Vec2(255, 249.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(255, 250.5);
      o15.pos_ = new Vec2(254, 252.5);
      o15.pos_ = new Vec2(253, 253.5);
      o15.pos_ = new Vec2(253, 254.5);
      o15.pos_ = new Vec2(253, 256.5);
      o15.pos_ = new Vec2(253, 258.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(253, 260.5);
      o15.pos_ = new Vec2(253, 262.5);
      o15.pos_ = new Vec2(252, 264.5);
      o15.pos_ = new Vec2(252, 265.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(252, 267.5);
      o15.pos_ = new Vec2(252, 268.5);
      o15.pos_ = new Vec2(251, 269.5);
      o15.pos_ = new Vec2(251, 270.5);
      o15.pos_ = new Vec2(251, 271.5);
      o15.pos_ = new Vec2(251, 273.5);
      o15.pos_ = new Vec2(251, 274.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(251, 275.5);
      o15.pos_ = new Vec2(251, 276.5);
      o15.pos_ = new Vec2(251, 277.5);
      o15.pos_ = new Vec2(251, 279.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(251, 280.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(251, 281.5);
      o15.pos_ = new Vec2(251, 282.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(250, 284.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(250, 286.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(250, 287.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(250, 288.5);
      o15.pos_ = new Vec2(250, 289.5);
      o15.pos_ = new Vec2(251, 290.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(251, 291.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(251, 292.5);
      o15.pos_ = new Vec2(251, 293.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(251, 294.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(253, 295.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(253, 297.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(253, 298.5);
      o15.pos_ = new Vec2(254, 299.5);
      o15.pos_ = new Vec2(254, 300.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(254, 301.5);
      o15.pos_ = new Vec2(254, 302.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(254, 303.5);
      o15.pos_ = new Vec2(254, 304.5);
      o15.pos_ = new Vec2(254, 305.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(255, 306.5);
      o15.pos_ = new Vec2(255, 307.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(255, 308.5);
      o15.pos_ = new Vec2(255, 309.5);
      o15.pos_ = new Vec2(255, 311.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(255, 313.5);
      o15.pos_ = new Vec2(255, 314.5);
      o15.pos_ = new Vec2(255, 315.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(255, 316.5);
      o15.pos_ = new Vec2(255, 317.5);
      o15.pos_ = new Vec2(255, 318.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(255, 319.5);
      o15.pos_ = new Vec2(255, 320.5);
      o15.pos_ = new Vec2(255, 321.5);
      o15.pos_ = new Vec2(255, 322.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(255, 323.5);
      o15.pos_ = new Vec2(255, 324.5);
      o15.pos_ = new Vec2(254, 325.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(254, 326.5);
      o15.pos_ = new Vec2(254, 327.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(252, 329.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(251, 331.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(250, 332.5);
      o15.pos_ = new Vec2(250, 333.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(249, 335.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(248, 336.5);
      o15.pos_ = new Vec2(248, 337.5);
      o15.pos_ = new Vec2(248, 338.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(247, 339.5);
      o15.pos_ = new Vec2(247, 340.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(246, 341.5);
      o15.pos_ = new Vec2(246, 342.5);
      o15.pos_ = new Vec2(245, 343.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(244, 344.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(244, 345.5);
      o15.pos_ = new Vec2(243, 346.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(243, 347.5);
      o15.pos_ = new Vec2(242, 348.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(241, 349.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(240, 350.5);
      o15.pos_ = new Vec2(240, 351.5);
      o15.pos_ = new Vec2(240, 352.5);
      o15.pos_ = new Vec2(239, 353.5);
      o15.pos_ = new Vec2(238, 354.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(238, 355.5);
      o15.pos_ = new Vec2(237, 356.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(236, 357.5);
      o15.pos_ = new Vec2(235, 359.5);
      o15.pos_ = new Vec2(235, 360.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(234, 360.5);
      o15.pos_ = new Vec2(233, 361.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(233, 362.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(233, 363.5);
      o15.pos_ = new Vec2(233, 364.5);
      o15.pos_ = new Vec2(233, 365.5);
      o15.pos_ = new Vec2(233, 366.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(233, 367.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(233, 368.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(233, 369.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(233, 370.5);
      o15.pos_ = new Vec2(234, 371.5);
      o15.pos_ = new Vec2(235, 372.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(236, 373.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(238, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(239, 375.5);
      o15.pos_ = new Vec2(240, 375.5);
      o15.pos_ = new Vec2(241, 375.5);
      o15.pos_ = new Vec2(242, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(243, 375.5);
      o15.pos_ = new Vec2(245, 375.5);
      o15.pos_ = new Vec2(247, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(249, 375.5);
      o15.pos_ = new Vec2(251, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(252, 375.5);
      o15.pos_ = new Vec2(254, 375.5);
      o15.pos_ = new Vec2(255, 375.5);
      o15.pos_ = new Vec2(256, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(257, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(258, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(260, 375.5);
      o15.pos_ = new Vec2(262, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(264, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(266, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(267, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(268, 375.5);
      o15.pos_ = new Vec2(269, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(271, 375.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(273, 377.5);
      o15.pos_ = new Vec2(275, 377.5);
      o15.pos_ = new Vec2(275, 378.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(275, 379.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(274, 379.5);
      o15.pos_ = new Vec2(273, 379.5);
      o15.pos_ = new Vec2(272, 379.5);
      o15.pos_ = new Vec2(271, 379.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(270, 380.5);
      o15.pos_ = new Vec2(269, 380.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(268, 380.5);
      o15.pos_ = new Vec2(267, 380.5);
      o15.pos_ = new Vec2(265, 380.5);
      o15.pos_ = new Vec2(264, 380.5);
      o15.pos_ = new Vec2(263, 381.5);
      o15.pos_ = new Vec2(263, 382.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(261, 382.5);
      o15.pos_ = new Vec2(259, 383.5);
      qt.updateObject(o15);
      o15.pos_ = new Vec2(258, 383.5);
      o15.pos_ = new Vec2(258, 384.5);
      o15.pos_ = new Vec2(257, 385.5);
      qt.updateObject(o15);

      qt.getPossibleCollisionsForObject(o3).should.eql({
        3  : o3,
        4  : o4,
        5  : o5,
        9  : o9,
        10 : o10,
        17 : o17,
        18 : o18
      });
    });
  });
});

